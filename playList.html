<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="數享秉持綠能永續經營理念，成為提供差異化服務的世界級RMN公司。我們致力於協助企業追求最高的利潤及成長，幫助企業轉型，規劃並建置完善的跨平台行銷。" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
  <script src="js/loading.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/rangepicker_single.css">
  <link rel="stylesheet" href="css/sweetalert2.css">
  <link rel="stylesheet" href="css/layout.css" type="text/css">
  <link rel="stylesheet" href="css/playList.css">
  <title>刊播列表</title>
</head>
<body>
  <header></header>
  <div id="main">
    <div class="content">
      <div class="title"></div>
      <div class="contentBG">
        <div class="keywordSearch"></div>
        <div class="textInfo">
          <img src="img/table/textInfo.svg" alt="">
          <div class="info">點選紫色字體可進行排序</div>
        </div>
        <div class="table-responsive playList">
          <table class="head_bg playList">
            <tr>
              <td class="check"></td>
              <td>ID</td>
              <td>刊播名稱</td>
              <td>縮圖</td>
              <td class="sort">狀態</td>
              <td class="sort">起訖日</td>
              <td class="sort">週期</td>
              <td>時段</td>
              <td>刊播人</td>
              <td>操作</td>
            </tr>
          </table>
          <div class="tableWp marginTop">
            <table class="mainTable playList" cellspacing="0" id="playList">
              <thead>
                <tr>
                  <th></th>
                  <th>刊播編號</th>
                  <th class="scroll">刊播名稱</th>
                  <th>縮圖</th>
                  <th class="sort">狀態</th>
                  <th class="sort">起訖日</th>
                  <th class="sort">週期</th>
                  <th>時段</th>
                  <th>刊播人</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody class="fbody">
                <tr class="main">
                  <td class="check" onclick="detail.call(this)">
                    <img src="img/table/close.svg" alt="" class="detailClose">
                  </td>
                  <td class="small postId">2405310001</td>
                  <td class="scroll">刊播名稱</td>
                  <td class="img"><img src="img/table/smallPhoto.png" alt=""></td>
                  <td class="prepare">準備</td>
                  <td class="small">23.06.06<br>|<br>24.06.06</td>
                  <td>每天</td>
                  <td class="column small">00:00<br>|<br>23:59</td>
                  <td class="small">AAAAA公司</td>
                  <td class="btnWP">
                    <p class="btnImg">
                      <span class="flex">
                        <i class="edit"><img src="img/table/edit.svg" alt="" class="edit" onClick="edit()">編輯</i>
                        <i class="replace" onClick="replace()"><img src="img/table/replace.svg" alt=""
                            class="replace">替換</i>
                        <i class="clone" onClick="clone()"><img src="img/table/clone.svg" alt="" class="clone">複製</i>
                        <i class="push" onClick="push()"><img src="img/table/push.svg" alt="" class="push">推播</i>
                      </span>
                      <span class="flex">
                        <i class="stop" onclick="stop()"><img src="img/table/stop.svg" alt="" class="stop">停播</i>
                        <i class="play"><img src="img/table/play.svg" alt="" class="play">播放</i>
                        <i class="delet" onclick="delet()"><img src="img/table/delet.svg" alt="" class="delet">刪除</i>
                      </span>
                    </p>
                  </td>
                </tr>
                <tr class="main">
                  <td class="check" onclick="detail.call(this)">
                    <img src="img/table/close.svg" alt="" class="detailClose">
                  </td>
                  <td class="small postId">2405300004</td>
                  <td class="scroll">刊播名稱</td>
                  <td class="img"><img src="img/table/smallPhoto.png" alt=""></td>
                  <td class="endplay">結束</td>
                  <td class="small">23.06.06<br>|<br>24.06.06</td>
                  <td>二、四</td>
                  <td class="column small">00:00<br>|<br>23:59</td>
                  <td class="small">BBBBBB公司</td>
                  <td class="btnWP">
                    <p class="btnImg">
                      <span class="flex">
                        <i class="edit"><img src="img/table/edit.svg" alt="" class="edit" onClick="edit()">編輯</i>
                        <i class="replace" onClick="replace()"><img src="img/table/replace.svg" alt=""
                            class="replace">替換</i>
                        <i class="clone" onClick="clone()"><img src="img/table/clone.svg" alt="" class="clone">複製</i>
                        <i class="push" onClick="push()"><img src="img/table/push.svg" alt="" class="push">推播</i>
                      </span>
                      <span class="flex">
                        <i class="stop" onclick="stop()"><img src="img/table/stop.svg" alt="" class="stop">停播</i>
                        <i class="play"><img src="img/table/play.svg" alt="" class="play">播放</i>
                        <i class="delet" onclick="delet()"><img src="img/table/delet.svg" alt="" class="delet">刪除</i>
                      </span>
                    </p>
                  </td>
                </tr>
                <tr class="main">
                  <td class="check" onclick="detail.call(this)">
                    <img src="img/table/close.svg" alt="" class="detailClose">
                  </td>
                  <td class="small postId">2405280005</td>
                  <td class="scroll">刊播名稱</td>
                  <td class="img"><img src="img/table/smallPhoto.png" alt=""></td>
                  <td class="playing">刊播</td>
                  <td class="small">23.07.06<br>|<br>24.12.21</td>
                  <td>週間</td>
                  <td class="column small">00:00<br>|<br>23:59</td>
                  <td class="small">CCCCCC公司</td>
                  <td class="btnWP">
                    <p class="btnImg">
                      <span class="flex">
                        <i class="edit"><img src="img/table/edit.svg" alt="" class="edit" onClick="edit()">編輯</i>
                        <i class="replace" onClick="replace()"><img src="img/table/replace.svg" alt=""
                            class="replace">替換</i>
                        <i class="clone" onClick="clone()"><img src="img/table/clone.svg" alt="" class="clone">複製</i>
                        <i class="push" onClick="push()"><img src="img/table/push.svg" alt="" class="push">推播</i>
                      </span>
                      <span class="flex">
                        <i class="stop" onclick="stop()"><img src="img/table/stop.svg" alt="" class="stop">停播</i>
                        <i class="play"><img src="img/table/play.svg" alt="" class="play">播放</i>
                        <i class="delet" onclick="delet()"><img src="img/table/delet.svg" alt="" class="delet">刪除</i>
                      </span>
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="popup_bg edit">
          <div class="popupWP edit small">
            <div class="titleWP">
              <p class="title">素材名稱</p>
              <p class="close">×</p>
            </div>
            <div class="swalWP">
              <p>確認編輯素材嗎 ?</p>
              <div class=" btnWP">
                <div class="btn edite_confirm small">確認</div>
              </div>
            </div>
          </div>
        </div>
        <div class="popup_bg clone">
          <div class="popupWP clone big">
            <div class="titleWP">
              <p class="title">新增素材</p>
              <p class="close">×</p>
            </div>
            <div class="swalWP">
              <div class="keywordSearch"></div>
              <div class="textInfo">
                <img src="img/table/textInfo.svg" alt="">
                <div class="info">點選紫色字體可進行排序</div>
              </div>
              <div class="selectContent">
                <div class="table-responsive clone">
                  <table class="head_bg clone">
                    <tr>
                      <td class="check"><input type="checkbox"></td>
                      <td>ID</td>
                      <td>縮圖</td>
                      <td>檔名</td>
                      <td class="sort">秒數</td>
                      <td class="sort">審核日</td>
                    </tr>
                  </table>
                  <div class="tableWp marginTop">
                    <table cellspacing="0" class="mainTable clone">
                      <thead>
                        <tr>
                          <th class=""><input type="checkbox"></th>
                          <th>ID</th>
                          <th>縮圖</th>
                          <th>檔名</th>
                          <th class="sort">秒數</th>
                          <th class="sort">審核日</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td class="check">
                            <input type="checkbox" name="mediaCheck">
                          </td>
                          <td>A123456789</td>
                          <td class="image"><img src="img/table/smallVideo.png" alt=""></td>
                          <td class="name">機場宣導</td>
                          <td>15</td>
                          <td>23.06.18</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="checkbox" name="mediaCheck">
                          </td>
                          <td>A123456789</td>
                          <td class="image"><img src="img/table/smallVideo.png" alt=""></td>
                          <td class="name">機場宣導</td>
                          <td>15</td>
                          <td>23.06.18</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="checkbox" name="mediaCheck">
                          </td>
                          <td>A123456789</td>
                          <td class="image"><img src="img/media/mediaImg.svg" alt=""></td>
                          <td class="name">機場宣導</td>
                          <td>15</td>
                          <td>23.06.18</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="checkbox" name="mediaCheck">
                          </td>
                          <td>A123456789</td>
                          <td class="image"><img src="img/media/mediaImg.svg" alt=""></td>
                          <td class="name">機場宣導</td>
                          <td>15</td>
                          <td>23.06.18</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="checkbox" name="mediaCheck">
                          </td>
                          <td>A123456789</td>
                          <td class="image"><img src="img/media/mediaImg.svg" alt=""></td>
                          <td class="name">機場宣導</td>
                          <td>15</td>
                          <td>23.06.18</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="checkbox" name="mediaCheck">
                          </td>
                          <td>A123456789</td>
                          <td class="image"><img src="img/table/smallVideo.png" alt=""></td>
                          <td class="name">機場宣導</td>
                          <td>15</td>
                          <td>23.06.18</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="checkbox" name="mediaCheck">
                          </td>
                          <td>A123456789</td>
                          <td class="image"><img src="img/table/smallVideo.png" alt=""></td>
                          <td class="name">機場宣導</td>
                          <td>15</td>
                          <td>23.06.18</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <div class=" btnWP">
                  <div class="btn clone_confirm small">確認</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="popup_bg replace">
          <div class="popupWP replace big">
            <div class="titleWP">
              <p class="title">替換素材</p>
              <p class="close">×</p>
            </div>
            <div class="swalWP">
              <div class="keywordSearch"></div>
              <div class="textInfo">
                <img src="img/table/textInfo.svg" alt="">
                <div class="info">點選紫色字體可進行排序</div>
              </div>
              <div class="selectContent">
                <div class="table-responsive replace">
                  <table class="head_bg replace">
                    <tr>
                      <td class="check"> <input type="radio" name="mediaRadio" class="option-input"></td>
                      <td>縮圖</td>
                      <td>檔名</td>
                      <td class="sort">秒數</td>
                      <td class="sort">審核日</td>
                    </tr>
                  </table>
                  <div class="tableWp marginTop">
                    <table cellspacing="0" class="mainTable replace">
                      <thead>
                        <tr>
                          <th class="check"></th>
                          <th>縮圖</th>
                          <th>檔名</th>
                          <th class="sort">秒數</th>
                          <th class="sort">審核日</th>
                        </tr>
                      </thead>
                      <tbody class="fbody">
                        <tr>
                          <td class="check">
                            <input type="radio" name="mediaRadio" class="option-input">
                          </td>
                          <td class="image"><img src="img/table/smallVideo.png" alt=""></td>
                          <td class="name">機場宣導</td>
                          <td>25</td>
                          <td>23.06.18</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="radio" name="mediaRadio" class="option-input">
                          </td>
                          <td class="image"><img src="img/table/smallVideo.png" alt=""></td>
                          <td class="name">八八節活動</td>
                          <td>30</td>
                          <td>23.07.18</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="radio" name="mediaRadio" class="option-input">
                          </td>
                          <td class="image"><img src="img/media/mediaImg.svg" alt=""></td>
                          <td class="name">歡慶母親節</td>
                          <td>25</td>
                          <td>23.04.20</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="radio" name="mediaRadio" class="option-input">
                          </td>
                          <td class="image"><img src="img/media/mediaImg.svg" alt=""></td>
                          <td class="name">兒童節來啦</td>
                          <td>20</td>
                          <td>23.03.20</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="radio" name="mediaRadio" class="option-input">
                          </td>
                          <td class="image"><img src="img/media/mediaImg.svg" alt=""></td>
                          <td class="name">週年慶買買買</td>
                          <td>15</td>
                          <td>23.09.17</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="radio" name="mediaRadio" class="option-input">
                          </td>
                          <td class="image"><img src="img/table/smallVideo.png" alt=""></td>
                          <td class="name">聖誕感恩回饋</td>
                          <td>15</td>
                          <td>23.12.18</td>
                        </tr>
                        <tr>
                          <td class="check">
                            <input type="radio" name="mediaRadio" class="option-input">
                          </td>
                          <td class="image"><img src="img/table/smallVideo.png" alt=""></td>
                          <td class="name">龍年大吉好運龍來</td>
                          <td>15</td>
                          <td>24.01.18</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <div class=" btnWP">
                  <div class="btn replace_confirm small">確認</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="popup_bg delet">
          <div class="popupWP delet small">
            <div class="titleWP">
              <p class="title">素材編號</p>
              <p class="close">×</p>
            </div>
            <div class="swalWP">
              <p>確認刪除此素材嗎 ?</p>
              <div class=" btnWP">
                <div class="btn delete_confirm small">確認</div>
              </div>
            </div>
          </div>
        </div>
        <div class="popup_bg stop">
          <div class="popupWP stop small">
            <div class="titleWP">
              <p class="title">素材編號</p>
              <p class="close">×</p>
            </div>
            <div class="swalWP">
              <p>確認暫停此素材嗎 ?</p>
              <div class=" btnWP">
                <div class="btn stop_confirm small">確認</div>
              </div>
            </div>
          </div>
        </div>
        <div class="popup_bg replaceDetail">
          <div class="popupWP replace big">
            <div class="titleWP">
              <p class="title">替換素材</p>
              <p class="close">×</p>
            </div>
            <div class="swalWP">
              <div class="selectContent">
                <div class="flex img">
                  <img src="img/media/detail_Img.svg" class="show detail" alt="">
                </div>
                <div class="flex name">
                  <p>檔名</p><span class="fontLevel_3">檔案的名稱可能會很長（？</span>
                </div>
                <div class="flex">
                  <p>秒數</p><span class="mac fontLevel_3">15</span>
                </div>
                <div class="flex">
                  <p>審核日</p><span class="mac fontLevel_3">23.06.18</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="popup_bg cloneDetail">
          <div class="popupWP clone big">
            <div class="titleWP">
              <p class="title">複製素材</p>
              <p class="close">×</p>
            </div>
            <div class="swalWP">
              <div class="selectContent">
                <div class="flex name">
                  <p>ID</p><span class="fontLevel_3">A123456789</span>
                </div>
                <div class="flex img">
                  <img src="img/media/detail_Img.svg" class="show detail" alt="">
                </div>
                <div class="flex name">
                  <p>檔名</p><span class="fontLevel_3">檔案的名稱可能會很長（？</span>
                </div>
                <div class="flex">
                  <p>秒數</p><span class="mac fontLevel_3">15</span>
                </div>
                <div class="flex">
                  <p>審核日</p><span class="mac fontLevel_3">23.06.18</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="sideNo">8</div>
  <script src="js/textInfo.js"></script>
  <script src="js/table.js"></script>
  <script src="js/datePicker.js"></script>
  <script>
    //get date time
    let dayNow = new Date();
    let day = dayNow.getDate();
    let month = dayNow.getMonth();
    let year = dayNow.getFullYear();

    //RWD popup tr detail

    $('.popupWP table tr').click(function () {
      if ($(window).width() < 600) {
        if ($(this).parents('table.mainTable').hasClass('replace')) {
          $('.replaceDetail').fadeIn().css({ 'display': 'flex' });
        } else {
          $('.cloneDetail').fadeIn().css({ 'display': 'flex' });
        }
        $('body').addClass('overflow');
      }
    });

    //edit
    function edit() {
      $('.popup_bg.edit').fadeIn().css({ 'display': 'flex' });
      $('body').addClass('overflow');
    };
    $('.popup_bg.edit .edite_confirm').click(function () {
      //到刊播
      window.location = "https://yowru.github.io/CMS/playStep1.html";
    });
    $('.popup_bg.clone .clone_confirm, .popup_bg.replace .replace_confirm').click(function () {
      //到清單列表
      if ($(this).parent('.btnWP').siblings('').find('input').filter(':checked').length > 0) {
        window.location = "https://yowru.github.io/CMS/playList.html";
      } else {
        Swal.fire('尚未選擇', '', 'info');
      }

    });

    function push() {
      Swal.fire('已送出', '', 'success');
    };

    function clone() {
      $('.popup_bg.clone').fadeIn().css({ 'display': 'flex' });
      $('body').addClass('overflow');
    };

    function replace() {
      $('.popup_bg.replace').fadeIn().css({ 'display': 'flex' });
      $('body').addClass('overflow');
    };

    //delet
    function delet() {
      $('.popup_bg.delet').fadeIn().css({ 'display': 'flex' });
      $('body').addClass('overflow');
    };

    //delete_btn
    $('.delete_confirm').click(function () {
      Swal.fire('確認刪除', '', 'success');
      $('.popup_bg').fadeOut();
    });

    //stop
    function stop() {
      $('.popup_bg.stop').fadeIn().css({ 'display': 'flex' });
      $('body').addClass('overflow');
    };

    //stop_btn
    $('.stop_confirm').click(function () {
      Swal.fire('確認暫停', '', 'success');
      $('.popup_bg').fadeOut();
    });

    //detail
    function detail() {
      let postID = $(this).siblings('td.postId').text();
      let dynamicContent;
      let newRow = `
        <tr class="detail">
          <td colspan="10">
            <table class="detailContent">
              <tr class="first">
                <th></th>
                <th>設備名稱</th>
                <th class="num">mac address</th>
                <th>地址</th>
                <th>狀態</th>
                <th>播放次數</th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
              </tr>
            </table>
          </td>
        </tr>`;

      if ($(this).children('img').hasClass('detailClose')) {
        $(this).children('img').prop({ 'src': 'img/table/open.svg', 'class': 'detailOpen' });
        $(this).parents('.main').after(newRow);
        $.ajax({
          url: `http://test.drmn.net/api/postdevice/${postID}`,
          type: "GET",
          dataType: "json",
          success: function (d) {
            console.log(JSON.stringify(d));
            d.forEach((item, index) => {
              dynamicContent += `
            <tr>
              <td></td>
              <td>${item.deviceName}</td>
              <td class="num">${item.mac}</td>
              <td>${item.address}</td>
              <td>${item.deviceStatus}</td>
              <td>${item.playCount}</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>`;
            });

          }, complete: (result) => {
            $(this).parents('.main').next('.detail').find('.detailContent').append(dynamicContent);
          },
          error: function (jqXHR, textStatus, errorThrown) {
            console.error("Error:", textStatus, errorThrown);
          }
        });
      } else {
        $(this).children('img').prop({ 'src': 'img/table/close.svg', 'class': 'detailClose' });
        $(this).parents('.main').next('.detail').remove();
      }
    };


    //tr & detail bgColor
    $('table.mainTable>tbody>tr:nth-child(4n+1) ').addClass('color');
    $('table.mainTable tr.color ').next('.detail').addClass('color');

    //close
    $('.popup_bg .titleWP .close').click(function () {
      $('.popup_bg').fadeOut();
      window.location.replace(location.href);
    });
  </script>
</body>

</html>